t = int(input())
for _ in range(t):
    n = int(input())
    a = [int(x) for x in input().split()]
    if a[0] == a[n - 1] == -1:
        a[0] = a[n - 1] = 0
    elif a[0] == -1 or a[n - 1] == -1:
        if a[0] == -1:
            a[0] = a[n - 1]
        else:
            a[n - 1] = a[0]
    for i in range(1,n-1):
        if a[i] == -1:
            a[i] = 0
    print(abs(a[n - 1] - a[0]))
    for i in range(n):
        print(a[i],end=" ")
    print()